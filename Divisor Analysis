#include <bits/stdc++.h>
using namespace std;
long long M=1e9+7;
long long e(long long a,long long b,long long m)
{
    long long r=1;
    a%=m;
    while(b>0)
    {
        if(b%2) r=(r*a)%m;
        a=(a*a)%m;
        b/=2;
    }
    return r;
}
int main()
{
    int n;cin>>n;
    long long d=1,s=1,p=1,c=1;
    while(n--)
    {
        long long x,k;cin>>x>>k;
        d=(d*(k+1))%M;
        long long t=(e(x,k+1,M)-1+M)%M;
        long long b=e(x-1,M-2,M);
        s=(s*t%M*b)%M;
        long long p1=e(p,k+1,M);
        long long g=(k%2==0)?(k/2%(M-1)*((k+1)%(M-1))):(k%(M-1)*((k+1)/2%(M-1)));
        long long p2=e(x,g%(M-1)*c%(M-1),M);
        p=(p1*p2)%M;
        c=(c*(k+1))%(M-1);
    }
    cout<<d<<" "<<s<<" "<<p;
}
